@use 'sass:meta';
@use 'sass:map';

$breakpoints: (
  xss: 0px,
  xs: 425px,
  sm: 576px,
  md: 768px,
  lg: 992px,
  xl: 1200px,
  xxl: 1400px,
) !default;

@function _to-px($value) {
  @if meta.type-of($value) == 'number' {
    @if unit($value) == '' {
      @return $value * 1px;
    }
    @return $value;
  }

  @if meta.type-of($value) == 'string' and map.has-key($breakpoints, $value) {
    @return map.get($breakpoints, $value);
  }

  // если строка но не ключ — пробуем парсить как размер (например "900px")
  @return $value;
}

// Основной миксин
// $bp - имя брейкпоинта (md) или число (900 / 900px)
// $dir - null (=> min-width), '<' (=> max-width), '<=' , '>' or '>=' (поддержка)
@mixin media($bp, $dir: null) {
  $px: _to-px($bp);

  // поддерживаем короткие директивы
  @if $dir == null or $dir == '>=' or $dir == '>' {
    @media (min-width: #{$px}) {
      @content;
    }
  } @else if $dir == '<' or $dir == '<=' {
    // вычитаем маленькую дробную часть чтобы не было перекрытия (используется часто для мобильных)
    $max: $px - 0.02px;
    @media (max-width: #{$max}) {
      @content;
    }
  } @else {
    // на будущее: если передан диапазон строкой "md-lg" (необязательно)
    @warn "Unsupported media direction `#{$dir}`. Use null/'>=' or '<'.";
    @media (min-width: #{$px}) {
      @content;
    }
  }
}
